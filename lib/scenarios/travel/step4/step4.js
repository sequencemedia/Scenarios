'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _regenerator=require('babel-runtime/regenerator');var _regenerator2=_interopRequireDefault(_regenerator);var _extends2=require('babel-runtime/helpers/extends');var _extends3=_interopRequireDefault(_extends2);var _objectWithoutProperties2=require('babel-runtime/helpers/objectWithoutProperties');var _objectWithoutProperties3=_interopRequireDefault(_objectWithoutProperties2);var _asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);var _toBool=require('../../../to-bool');var _toBool2=_interopRequireDefault(_toBool);var _logger=require('../../../logger');var _logger2=_interopRequireDefault(_logger);var _step4EnterAddress=require('./step4-enter-address');var _step4EnterAddress2=_interopRequireDefault(_step4EnterAddress);var _step4EnterEmail=require('./step4-enter-email');var _step4EnterEmail2=_interopRequireDefault(_step4EnterEmail);var _step4SelectOptIn=require('./step4-select-opt-in');var _step4SelectOptIn2=_interopRequireDefault(_step4SelectOptIn);var _step4SelectAcceptConditions=require('./step4-select-accept-conditions');var _step4SelectAcceptConditions2=_interopRequireDefault(_step4SelectAcceptConditions);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}/* eslint no-nested-ternary: "off" */exports.default=function(){var _ref=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee(_ref2){var _ref3=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var _ref3$selectOptIn=_ref3.selectOptIn,optIn=_ref3$selectOptIn===undefined?false:_ref3$selectOptIn,_ref3$selectAcceptCon=_ref3.selectAcceptConditions,acceptConditions=_ref3$selectAcceptCon===undefined?true:_ref3$selectAcceptCon,params=(0,_objectWithoutProperties3.default)(_ref3,['selectOptIn','selectAcceptConditions']);var page=_ref2.page,config=(0,_objectWithoutProperties3.default)(_ref2,['page']);var _ref4$message,message;return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return page.waitForSelector('[data-step-index="4"]',{visible:true});case 3:_context.next=5;return page.click('[data-step-index="4"]');case 5:_context.next=7;return(0,_step4EnterAddress2.default)((0,_extends3.default)({},config,{page:page}),params);case 7:_context.next=9;return(0,_step4EnterEmail2.default)((0,_extends3.default)({},config,{page:page}),params);case 9:if(!(0,_toBool2.default)(optIn)){_context.next=12;break;}_context.next=12;return(0,_step4SelectOptIn2.default)((0,_extends3.default)({},config,{page:page}),params);case 12:if(!(0,_toBool2.default)(acceptConditions)){_context.next=15;break;}_context.next=15;return(0,_step4SelectAcceptConditions2.default)((0,_extends3.default)({},config,{page:page}),params);case 15:_context.next=17;return page.click('[data-step-index="4"] .accept-conditions');case 17:_context.next=19;return page.evaluate(function(){document.querySelector('[data-step-index="4"] .accept-conditions .buy-btn a').scrollIntoView({behaviour:'instant'});});case 19:_context.next=21;return page.focus('[data-step-index="4"] .accept-conditions .buy-btn a');case 21:_context.next=23;return page.click('[data-step-index="4"] .accept-conditions .buy-btn a');case 23:_context.next=30;break;case 25:_context.prev=25;_context.t0=_context['catch'](0);_ref4$message=_context.t0.message;message=_ref4$message===undefined?'No error message is defined':_ref4$message;_logger2.default.error('Error in Step 4. '+message.trim());case 30:case'end':return _context.stop();}}},_callee,undefined,[[0,25]]);}));return function(_x){return _ref.apply(this,arguments);};}();