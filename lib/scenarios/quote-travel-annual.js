'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _regenerator=require('babel-runtime/regenerator');var _regenerator2=_interopRequireDefault(_regenerator);var _asyncToGenerator2=require('babel-runtime/helpers/asyncToGenerator');var _asyncToGenerator3=_interopRequireDefault(_asyncToGenerator2);var _puppeteer=require('puppeteer');var _puppeteer2=_interopRequireDefault(_puppeteer);var _travel=require('./travel');var _step1EnterAnnualDates=require('./travel/step1/step1-enter-annual-dates');var _step1EnterAnnualDates2=_interopRequireDefault(_step1EnterAnnualDates);var _step1EnterProfile=require('./travel/step1/step1-enter-profile');var _step1EnterProfile2=_interopRequireDefault(_step1EnterProfile);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}var step2=_travel.step2.step2;var step3=_travel.step3.step3;var step4=_travel.step4.step4;var step1=function(){var _ref=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee(page){var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};return _regenerator2.default.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return page.waitForSelector('[data-step-index="1"]',{visible:true});case 2:_context.next=4;return page.click('[data-step-index="1"]');case 4:_context.next=6;return(0,_step1EnterAnnualDates2.default)(page,params);case 6:_context.next=8;return(0,_step1EnterProfile2.default)(page,params);case 8:_context.next=10;return page.click('[data-step-index="1"] button.cta-button');case 10:case'end':return _context.stop();}}},_callee,undefined);}));return function step1(_x){return _ref.apply(this,arguments);};}();exports.default=function(){var _ref2=(0,_asyncToGenerator3.default)(/*#__PURE__*/_regenerator2.default.mark(function _callee2(){var _ref3=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},env=_ref3.env,_ref3$lang=_ref3.lang,lang=_ref3$lang===undefined?'en':_ref3$lang,_ref3$headless=_ref3.headless,headless=_ref3$headless===undefined?true:_ref3$headless,_ref3$w=_ref3.w,width=_ref3$w===undefined?1024:_ref3$w,_ref3$h=_ref3.h,height=_ref3$h===undefined?768:_ref3$h;var params=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var browser,page;return _regenerator2.default.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _puppeteer2.default.launch({headless:headless,args:['--window-size='+width+','+height]});case 2:browser=_context2.sent;_context2.next=5;return browser.newPage();case 5:page=_context2.sent;_context2.next=8;return page.setViewport({width:width,height:height});case 8:_context2.next=10;return page.goto('http://'+env+'/'+lang+'/quote');case 10:_context2.next=12;return(0,_travel.annual)(page,params);case 12:_context2.next=14;return page.waitForNavigation();case 14:_context2.next=16;return step1(page,params);case 16:_context2.next=18;return step2(page,params);case 18:_context2.next=20;return step3(page,params);case 20:_context2.next=22;return step4(page,params);case 22:_context2.next=24;return page.waitForNavigation();case 24:_context2.next=26;return(0,_travel.altapay)(page,params);case 26:_context2.next=28;return page.waitForNavigation({waitUntil:'networkidle2'});case 28:_context2.next=30;return browser.close();case 30:case'end':return _context2.stop();}}},_callee2,undefined);}));return function(){return _ref2.apply(this,arguments);};}();